<!DOCTYPE html>
<html lang="de-DE" dir="ltr" itemscope itemtype="http://schema.org/Article" data-r-output-format="html">
  <head><script src="/2024-2025-ZK_Data_Librarian_Modul_3/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=2024-2025-ZK_Data_Librarian_Modul_3/livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.144.1">
    <meta name="generator" content="Relearn 7.4.0">
    <meta name="description" content="Text-Klassifikations-Beispiel Das Beispiel basiert auf einem offenen Datensat von Newsgroup-Nachtrichten und orientiert sich an diesem offiziellen Tutorial von scikit-learn zur Textanalyse.
Wir nutzen Dokumente von mehreren Newsgroups und trainieren damit einen Classifier, der dann eine Zudordnung von neuen Texten auf eine dieser Gruppen durchführen kann. Sprich die Newsgroups stellen die Klassen/Tags dar, mit denen wir neue Texte klassifizieren. Wie nutzen einen einfachen Bag-of-Word-Ansatz in dem wir (normalisierte) Häufigkeit von Wörtern als Features nutzen.
In diesem Fall liegen die Daten noch nicht als Teil von scikit-learn vor, es wird aber eine Funktion angeboten, mit die Daten bezogen werden können.">
    <meta name="author" content="Malte Bonart, Ania Lopez and Konrad Förstner">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Text-Klassifikation :: Zertifikatskurs Data Librarian - Modul 3 - Daten analysieren und darstellen">
    <meta name="twitter:description" content="Text-Klassifikations-Beispiel Das Beispiel basiert auf einem offenen Datensat von Newsgroup-Nachtrichten und orientiert sich an diesem offiziellen Tutorial von scikit-learn zur Textanalyse.
Wir nutzen Dokumente von mehreren Newsgroups und trainieren damit einen Classifier, der dann eine Zudordnung von neuen Texten auf eine dieser Gruppen durchführen kann. Sprich die Newsgroups stellen die Klassen/Tags dar, mit denen wir neue Texte klassifizieren. Wie nutzen einen einfachen Bag-of-Word-Ansatz in dem wir (normalisierte) Häufigkeit von Wörtern als Features nutzen.
In diesem Fall liegen die Daten noch nicht als Teil von scikit-learn vor, es wird aber eine Funktion angeboten, mit die Daten bezogen werden können.">
    <meta property="og:url" content="http://localhost:1313/2024-2025-ZK_Data_Librarian_Modul_3/text_analysis/text_classification/index.html">
    <meta property="og:site_name" content="Zertifikatskurs Data Librarian - Modul 3 - Daten analysieren und darstellen">
    <meta property="og:title" content="Text-Klassifikation :: Zertifikatskurs Data Librarian - Modul 3 - Daten analysieren und darstellen">
    <meta property="og:description" content="Text-Klassifikations-Beispiel Das Beispiel basiert auf einem offenen Datensat von Newsgroup-Nachtrichten und orientiert sich an diesem offiziellen Tutorial von scikit-learn zur Textanalyse.
Wir nutzen Dokumente von mehreren Newsgroups und trainieren damit einen Classifier, der dann eine Zudordnung von neuen Texten auf eine dieser Gruppen durchführen kann. Sprich die Newsgroups stellen die Klassen/Tags dar, mit denen wir neue Texte klassifizieren. Wie nutzen einen einfachen Bag-of-Word-Ansatz in dem wir (normalisierte) Häufigkeit von Wörtern als Features nutzen.
In diesem Fall liegen die Daten noch nicht als Teil von scikit-learn vor, es wird aber eine Funktion angeboten, mit die Daten bezogen werden können.">
    <meta property="og:locale" content="de_DE">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Machinelles Lernen - Automatische Textanalyse">
    <meta itemprop="name" content="Text-Klassifikation :: Zertifikatskurs Data Librarian - Modul 3 - Daten analysieren und darstellen">
    <meta itemprop="description" content="Text-Klassifikations-Beispiel Das Beispiel basiert auf einem offenen Datensat von Newsgroup-Nachtrichten und orientiert sich an diesem offiziellen Tutorial von scikit-learn zur Textanalyse.
Wir nutzen Dokumente von mehreren Newsgroups und trainieren damit einen Classifier, der dann eine Zudordnung von neuen Texten auf eine dieser Gruppen durchführen kann. Sprich die Newsgroups stellen die Klassen/Tags dar, mit denen wir neue Texte klassifizieren. Wie nutzen einen einfachen Bag-of-Word-Ansatz in dem wir (normalisierte) Häufigkeit von Wörtern als Features nutzen.
In diesem Fall liegen die Daten noch nicht als Teil von scikit-learn vor, es wird aber eine Funktion angeboten, mit die Daten bezogen werden können.">
    <meta itemprop="wordCount" content="674">
    <title>Text-Klassifikation :: Zertifikatskurs Data Librarian - Modul 3 - Daten analysieren und darstellen</title><link rel="icon" href="/2024-2025-ZK_Data_Librarian_Modul_3/images/favicon.png" type="image/png">

    <link href="/2024-2025-ZK_Data_Librarian_Modul_3/css/fontawesome-all.min.css?1739985621" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/2024-2025-ZK_Data_Librarian_Modul_3/css/fontawesome-all.min.css?1739985621" rel="stylesheet"></noscript>
    <link href="/2024-2025-ZK_Data_Librarian_Modul_3/css/auto-complete.css?1739985621" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/2024-2025-ZK_Data_Librarian_Modul_3/css/auto-complete.css?1739985621" rel="stylesheet"></noscript>
    <link href="/2024-2025-ZK_Data_Librarian_Modul_3/css/perfect-scrollbar.min.css?1739985621" rel="stylesheet">
    <link href="/2024-2025-ZK_Data_Librarian_Modul_3/css/theme.css?1739985621" rel="stylesheet">
    <link href="/2024-2025-ZK_Data_Librarian_Modul_3/css/format-html.css?1739985621" rel="stylesheet" id="R-format-style">
    <script>
      window.relearn = window.relearn || {};
      window.relearn.relBasePath='..\/..';
      window.relearn.relBaseUri='..\/..\/..';
      window.relearn.absBaseUri='http:\/\/localhost:1313\/2024-2025-ZK_Data_Librarian_Modul_3';
      window.relearn.min = ``;
      window.relearn.disableAnchorCopy=false;
      window.relearn.disableAnchorScrolling=false;
      window.relearn.enableBlockCodeWrap=true;
      window.relearn.disableInlineCopyToClipboard=false;
      // variant stuff
      window.relearn.themevariants = [ 'green' ];
      window.relearn.customvariantname = "my-custom-variant";
      window.relearn.changeVariant = function(variant) {
        var oldVariant = document.documentElement.dataset.rThemeVariant;
        window.localStorage.setItem(window.relearn.absBaseUri + "/variant", variant);
        document.documentElement.dataset.rThemeVariant = variant;
        if (oldVariant != variant) {
          document.dispatchEvent( new CustomEvent('themeVariantLoaded', { detail: { variant, oldVariant } }) );
        }
      }
      window.relearn.markVariant = function() {
        var variant = window.localStorage.getItem(window.relearn.absBaseUri + "/variant");
        var select = document.querySelector("#R-select-variant");
        if (select) {
          select.value = variant;
        }
      }
      window.relearn.initVariant = function() {
        var variant = window.localStorage.getItem(window.relearn.absBaseUri + "/variant") ?? "";
        if( variant == window.relearn.customvariantname ){
        }else if( !variant || !window.relearn.themevariants.includes(variant) ){
          variant = window.relearn.themevariants[0];
          window.localStorage.setItem(window.relearn.absBaseUri + "/variant", variant);
        }
        document.documentElement.dataset.rThemeVariant = variant;
      }
      window.relearn.initVariant();
      window.relearn.markVariant();
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
    </script>
    <link href="/2024-2025-ZK_Data_Librarian_Modul_3/css/custom.css?1739985621" rel="stylesheet">
  </head>
  <body class="mobile-support html" data-url="/2024-2025-ZK_Data_Librarian_Modul_3/text_analysis/text_classification/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList">
            <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="/2024-2025-ZK_Data_Librarian_Modul_3/index.html"><span itemprop="name">Modul 3</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li>
            <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="/2024-2025-ZK_Data_Librarian_Modul_3/text_analysis/index.html"><span itemprop="name">Machinelles Lernen - Automatische Textanalyse</span></a><meta itemprop="position" content="2">&nbsp;>&nbsp;</li>
            <li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><span itemprop="name">Text-Klassifikation</span><meta itemprop="position" content="3"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-prev" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/2024-2025-ZK_Data_Librarian_Modul_3/text_analysis/index.html" title="Machinelles Lernen - Automatische Textanalyse (🡐)"><i class="fa-fw fas fa-chevron-left"></i></a>
            </div>
            <div class="topbar-button topbar-button-next" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/2024-2025-ZK_Data_Librarian_Modul_3/text_analysis/quiz/index.html" title="Quiz (🡒)"><i class="fa-fw fas fa-chevron-right"></i></a>
            </div>
            <div class="topbar-button topbar-button-more" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="More"><i class="fa-fw fas fa-ellipsis-v"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
                  <div class="topbar-area topbar-area-more" data-area="more">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable text_analysis" tabindex="-1">
        <div class="flex-block-wrapper">
<article class="default">
  <header class="headline">
  </header>

<h1 id="text-klassifikation">Text-Klassifikation</h1>

<h1 id="text-klassifikations-beispiel">Text-Klassifikations-Beispiel</h1>
<p>Das Beispiel basiert auf einem <a href="http://qwone.com/~jason/20Newsgroups/" rel="external" target="_blank">offenen
Datensat</a> von
<a href="https://de.wikipedia.org/wiki/Newsgroup" rel="external" target="_blank">Newsgroup-Nachtrichten</a> und
orientiert sich an <a href="https://scikit-learn.org/stable/tutorial/text_analytics/working_with_text_data.html" rel="external" target="_blank">diesem offiziellen
Tutorial</a>
von scikit-learn zur Textanalyse.</p>
<p>Wir nutzen Dokumente von mehreren Newsgroups und trainieren damit
einen Classifier, der dann eine Zudordnung von neuen Texten auf eine
dieser Gruppen durchführen kann. Sprich die Newsgroups stellen die
Klassen/Tags dar, mit denen wir neue Texte klassifizieren. Wie nutzen
einen einfachen
<a href="https://en.wikipedia.org/wiki/Bag-of-words_model" rel="external" target="_blank">Bag-of-Word</a>-Ansatz
in dem wir (normalisierte) Häufigkeit von Wörtern als Features nutzen.</p>
<p>In diesem Fall liegen die Daten noch nicht als Teil von <code>scikit-learn</code>
vor, es wird aber eine Funktion angeboten, mit die Daten bezogen werden
können.</p>

<div class="customnotices">
  <div class="notices_inner" id="code">
    <div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.datasets <span style="color:#f92672">import</span> fetch_20newsgroups</span></span></code></pre></div>

  </div>
</div>

<p>Wir legen vier Newsgroups, die wir nutzen wollen, fest.</p>

<div class="customnotices">
  <div class="notices_inner" id="code">
    <div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>selected_categories <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#34;sci.crypt&#34;</span>, <span style="color:#e6db74">&#34;sci.electronics&#34;</span>, <span style="color:#e6db74">&#34;sci.med&#34;</span>, <span style="color:#e6db74">&#34;sci.space&#34;</span>]</span></span></code></pre></div>

  </div>
</div>

<p>Wir beziehen die Trainingset- und Testsets-Dokumente.</p>

<div class="customnotices">
  <div class="notices_inner" id="code">
    <div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>newsgroup_posts_train <span style="color:#f92672">=</span> fetch_20newsgroups(
</span></span><span style="display:flex;"><span>    data_home<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;newsgroup_data&#34;</span>,
</span></span><span style="display:flex;"><span>    subset<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;train&#39;</span>,
</span></span><span style="display:flex;"><span>    categories<span style="color:#f92672">=</span>selected_categories,
</span></span><span style="display:flex;"><span>    shuffle<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>newsgroup_posts_test <span style="color:#f92672">=</span> fetch_20newsgroups(
</span></span><span style="display:flex;"><span>    data_home<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;newsgroup_data&#34;</span>,
</span></span><span style="display:flex;"><span>    subset<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;test&#39;</span>,
</span></span><span style="display:flex;"><span>    categories<span style="color:#f92672">=</span>selected_categories,
</span></span><span style="display:flex;"><span>    shuffle<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)</span></span></code></pre></div>

  </div>
</div>

<p>Die Objekte, die wir erhalten, sind <code>scikit-learn</code>-Bunches &hellip;

<div class="customnotices">
  <div class="notices_inner" id="code">
    <div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>type(newsgroup_posts_train)</span></span></code></pre></div>

  </div>
</div>
</p>
<p>&hellip; und haben die üblichen Attribute von Bunches.

<div class="customnotices">
  <div class="notices_inner" id="code">
    <div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>dir(newsgroup_posts_train)</span></span></code></pre></div>

  </div>
</div>
</p>
<p>U.a. exitiert die übliche Beschreibung des Datensets im Attribute
<code>DESCR</code>, die wir uns ansehen können.</p>

<div class="customnotices">
  <div class="notices_inner" id="code">
    <div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(newsgroup_posts_train<span style="color:#f92672">.</span>DESCR)</span></span></code></pre></div>

  </div>
</div>

<p>Das Attribut <code>data</code> enthält in diesem Fall keine Matrix, sondern
Newsgroup-Message-Texte.  Ein Beispiel schauen wir uns an:</p>

<div class="customnotices">
  <div class="notices_inner" id="code">
    <div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(newsgroup_posts_train<span style="color:#f92672">.</span>data[<span style="color:#ae81ff">6</span>])</span></span></code></pre></div>

  </div>
</div>

<p>Die Targets sind die Newsgroup-Namen. Diese Klassen sind wie üblich
für <code>scikit-learn</code> als Zahlen kodiert, die wir mittels <code>target_names</code>
auflösen können.</p>

<div class="customnotices">
  <div class="notices_inner" id="code">
    <div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(newsgroup_posts_train<span style="color:#f92672">.</span>target_names)</span></span></code></pre></div>

  </div>
</div>

<p>Für unsere Beispiel-Message:

<div class="customnotices">
  <div class="notices_inner" id="code">
    <div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>newsgroup_posts_train<span style="color:#f92672">.</span>target_names[newsgroup_posts_train<span style="color:#f92672">.</span>target[<span style="color:#ae81ff">6</span>]]</span></span></code></pre></div>

  </div>
</div>
</p>
<p>Um die Wörter zu zählen, aber auch um Stopwörte zu entfernen und zu
Tokenisieren nutzen wir ein Objekt der
<a href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html" rel="external" target="_blank">CountVectorizer-Klasse</a>
bzw. dessen <code>fit</code>-Methode</p>

<div class="customnotices">
  <div class="notices_inner" id="code">
    <div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.feature_extraction.text <span style="color:#f92672">import</span> CountVectorizer
</span></span><span style="display:flex;"><span>count_vect <span style="color:#f92672">=</span> CountVectorizer()
</span></span><span style="display:flex;"><span>count_vect<span style="color:#f92672">.</span>fit(newsgroup_posts_train<span style="color:#f92672">.</span>data)</span></span></code></pre></div>

  </div>
</div>

<p>Über alle Dokumente bekommen wir die folgende Zusammenstellung der
Wörter und ihre Indices (positionen im Array):

<div class="customnotices">
  <div class="notices_inner" id="code">
    <div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>len(count_vect<span style="color:#f92672">.</span>get_feature_names_out())</span></span></code></pre></div>

  </div>
</div>
</p>
<p>Wir können uns ein paar Beispiele ansehen &hellip;

<div class="customnotices">
  <div class="notices_inner" id="code">
    <div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>count_vect<span style="color:#f92672">.</span>get_feature_names_out()[<span style="color:#ae81ff">10000</span>:<span style="color:#ae81ff">10050</span>]</span></span></code></pre></div>

  </div>
</div>
</p>
<p>&hellip; oder sogar das counting-Dictionary mit den Wörtern und ihre
Vorkommen-Anzahl betrachten (Achtung: groß!).</p>

<div class="customnotices">
  <div class="notices_inner" id="code">
    <div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(count_vect<span style="color:#f92672">.</span>vocabulary_)</span></span></code></pre></div>

  </div>
</div>

<p>Diese Countings müssen wir für den Klassifikator in eine Matrix transformieren:</p>

<div class="customnotices">
  <div class="notices_inner" id="code">
    <div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>X_train_counts <span style="color:#f92672">=</span> count_vect<span style="color:#f92672">.</span>transform(newsgroup_posts_train<span style="color:#f92672">.</span>data)</span></span></code></pre></div>

  </div>
</div>

<p>Die Matrix, die wir erhalten, hat folgende Maße:

<div class="customnotices">
  <div class="notices_inner" id="code">
    <div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>X_train_counts<span style="color:#f92672">.</span>shape</span></span></code></pre></div>

  </div>
</div>
</p>
<p>Wir normalisieren die Wörtercoutings auf die Anzahl an Wörter im Text
(Term Frequency - TF). Dazu nutzen wir eine Objekt der Klasse
<a href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfTransformer.html" rel="external" target="_blank">TfidfTransformer</a>
(schalten die idf-Normalisierung (Inverse Document Frequency) dabei
ab.)</p>

<div class="customnotices">
  <div class="notices_inner" id="code">
    <div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.feature_extraction.text <span style="color:#f92672">import</span> TfidfTransformer
</span></span><span style="display:flex;"><span>tf_transformer <span style="color:#f92672">=</span> TfidfTransformer(use_idf<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)</span></span></code></pre></div>

  </div>
</div>

<p>Die Normalisierung erfolgt mit den Methoden <code>fit</code> und <code>transform</code>.

<div class="customnotices">
  <div class="notices_inner" id="code">
    <div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>tf_transformer<span style="color:#f92672">.</span>fit(X_train_counts)
</span></span><span style="display:flex;"><span>X_train_tf <span style="color:#f92672">=</span> tf_transformer<span style="color:#f92672">.</span>transform(X_train_counts)</span></span></code></pre></div>

  </div>
</div>
</p>
<p>Die Matrix, die wir erhalten, hat folgende Maße:

<div class="customnotices">
  <div class="notices_inner" id="code">
    <div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>X_train_tf<span style="color:#f92672">.</span>shape</span></span></code></pre></div>

  </div>
</div>
</p>
<p>Jetzt können wir einen Klassifikator erstellen. Wir Nutzen hier eine
Random-Forest-Klassifikator, könnten aber auch eine andere Methode
wählen.</p>

<div class="customnotices">
  <div class="notices_inner" id="code">
    <div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.ensemble <span style="color:#f92672">import</span> RandomForestClassifier
</span></span><span style="display:flex;"><span>tf_random_forest_classifier <span style="color:#f92672">=</span> RandomForestClassifier()</span></span></code></pre></div>

  </div>
</div>

<p>Wie bei allen Supervised-Learning-Verfahren trainieren wir den
Klassikator mit der Trainingsmatrix.</p>

<div class="customnotices">
  <div class="notices_inner" id="code">
    <div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>tf_random_forest_classifier<span style="color:#f92672">.</span>fit(X_train_tf, newsgroup_posts_train<span style="color:#f92672">.</span>target)</span></span></code></pre></div>

  </div>
</div>

<p>Um zu testen wie gut der Klassifikator funktioniert, prozessieren wir
das Test-Set mit dem CountVectorizer-Objekt und führen die gleiche
TF-Transformation durch.</p>

<div class="customnotices">
  <div class="notices_inner" id="code">
    <div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>X_test_counts <span style="color:#f92672">=</span> count_vect<span style="color:#f92672">.</span>transform(newsgroup_posts_test<span style="color:#f92672">.</span>data)
</span></span><span style="display:flex;"><span>X_test_tf <span style="color:#f92672">=</span> tf_transformer<span style="color:#f92672">.</span>transform(X_test_counts)</span></span></code></pre></div>

  </div>
</div>

<p>Ein kurze Blick auf die Maße der Matrix, zeigt uns, dass die Anzahl an
Spalten (Features) gleich ist wie bei der Trainingsmatrix.</p>

<div class="customnotices">
  <div class="notices_inner" id="code">
    <div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>X_test_counts<span style="color:#f92672">.</span>shape</span></span></code></pre></div>

  </div>
</div>

<p>Jetzt können wir mit der <code>score</code>-Methods die Güte des Klassikators auf
dem Test-Set prüfen.</p>

<div class="customnotices">
  <div class="notices_inner" id="code">
    <div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>tf_random_forest_classifier<span style="color:#f92672">.</span>score(X_test_tf, newsgroup_posts_test<span style="color:#f92672">.</span>target)</span></span></code></pre></div>

  </div>
</div>

<p>Der Klassifikator scheint gut genug zu funktionieren. Wir können jetzt
Listen von Dokumenten klassifizieren. Wir nehmen zwei Dokumete aus
unserem Test-Set und erstellen zusätzlich ein sehr kleines eigene
Dokument, das nur aus einem Satz bestehent.</p>

<div class="customnotices">
  <div class="notices_inner" id="code">
    <div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>docs_to_classify <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    newsgroup_posts_test<span style="color:#f92672">.</span>data[<span style="color:#ae81ff">1</span>],
</span></span><span style="display:flex;"><span>    newsgroup_posts_test<span style="color:#f92672">.</span>data[<span style="color:#ae81ff">7</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;The sun send a lot of radiation to the planets including earth&#34;</span>]</span></span></code></pre></div>

  </div>
</div>

<p>Werfen wir einen kurzen Blick auf die zwei Dokumente aus dem Testset.

<div class="customnotices">
  <div class="notices_inner" id="code">
    <div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(newsgroup_posts_test<span style="color:#f92672">.</span>data[<span style="color:#ae81ff">1</span>])</span></span></code></pre></div>

  </div>
</div>
</p>

<div class="customnotices">
  <div class="notices_inner" id="code">
    <div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(newsgroup_posts_test<span style="color:#f92672">.</span>data[<span style="color:#ae81ff">7</span>])</span></span></code></pre></div>

  </div>
</div>

<p>Auch diese neu zu klassifizierenden Dokumente müssen wir wie die
Traininsdokumente in Matrizen transformieren:</p>

<div class="customnotices">
  <div class="notices_inner" id="code">
    <div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>X_to_classify_counts <span style="color:#f92672">=</span> count_vect<span style="color:#f92672">.</span>transform(docs_to_classify)
</span></span><span style="display:flex;"><span>X_to_classify_tf <span style="color:#f92672">=</span> tf_transformer<span style="color:#f92672">.</span>transform(X_to_classify_counts)</span></span></code></pre></div>

  </div>
</div>

<p>Jetzt können wir mit dieser Matrix die Klassifikation durchführen &hellip;</p>

<div class="customnotices">
  <div class="notices_inner" id="code">
    <div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>predicted_classes <span style="color:#f92672">=</span> tf_random_forest_classifier<span style="color:#f92672">.</span>predict(X_to_classify_tf)</span></span></code></pre></div>

  </div>
</div>

<p>&hellip; und uns die Klassen anschauen, mit denen die Dokumente versehen wurden.</p>

<div class="customnotices">
  <div class="notices_inner" id="code">
    <div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> predicted_class <span style="color:#f92672">in</span> predicted_classes:
</span></span><span style="display:flex;"><span>    print(newsgroup_posts_train<span style="color:#f92672">.</span>target_names[predicted_class])</span></span></code></pre></div>

  </div>
</div>

<p>Um den Klassifikator zu verbessern, testen wir statt der Term-Frequenz
nun die TFIDF (Term Frequency times Inverse Document Frequency) und
erstellen damit unsere Matrizen.</p>

<div class="customnotices">
  <div class="notices_inner" id="code">
    <div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>tfidf_transformer <span style="color:#f92672">=</span> TfidfTransformer(use_idf<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)<span style="color:#f92672">.</span>fit(X_train_counts)</span></span></code></pre></div>

  </div>
</div>

<p>Mach mit diesem TFIDF-Ansatz äquivalent zu der Klassifikation mit
dem TF-Ansatz weiter. D.h. führe alle nötigen Schritte wie Training,
Scoring und Prediction durch. Ist das Ergebnis besser? Gerne kannst
Du zusätzlich mit anderen Klassifikator-Typen anstelle von Randeom
Forest experiment werden (z.B. SVMs oder neuronale Netzen), um zu
testen, ob dies zu einer besseren Klassifikation führt.</p>

  <footer class="footline">
  </footer>
</article>
        </div>
      </main>
    </div>
    <aside id="R-sidebar" class="default-animation showVisitedLinks">
      <div id="R-header-topbar" class="default-animation"></div>
      <div id="R-header-wrapper" class="default-animation">
        <div id="R-header" class="default-animation">
<a id="logo" href="http://localhost:1313/2024-2025-ZK_Data_Librarian_Modul_3/">
  <h4 style="font-size:2.5rem;overflow-wrap:anywhere;">Data Librarian</h3>
  <h6 style="font-size:1rem;overflow-wrap: anywhere;">Modul 3: Data analysieren und darstellen</h3>
</a>

        </div>
        <script>
          window.index_js_url="/2024-2025-ZK_Data_Librarian_Modul_3/searchindex.en.js?1739985621";
        </script>
        <search><form action="/2024-2025-ZK_Data_Librarian_Modul_3/search/index.html" method="get">
          <div class="searchbox default-animation">
            <button class="search-detail" type="submit" title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
            <label class="a11y-only" for="R-search-by">Search</label>
            <input data-search-input id="R-search-by" name="search-by" class="search-by" type="search" placeholder="Search...">
            <button class="search-clear" type="button" data-search-clear="" title="Clear search"><i class="fas fa-times" title="Clear search"></i></button>
          </div>
        </form></search>
        <script>
          var contentLangs=['de'];
        </script>
        <script src="/2024-2025-ZK_Data_Librarian_Modul_3/js/auto-complete.js?1739985621" defer></script>
        <script src="/2024-2025-ZK_Data_Librarian_Modul_3/js/lunr/lunr.min.js?1739985621" defer></script>
        <script src="/2024-2025-ZK_Data_Librarian_Modul_3/js/lunr/lunr.stemmer.support.min.js?1739985621" defer></script>
        <script src="/2024-2025-ZK_Data_Librarian_Modul_3/js/lunr/lunr.multi.min.js?1739985621" defer></script>
        <script src="/2024-2025-ZK_Data_Librarian_Modul_3/js/lunr/lunr.de.min.js?1739985621" defer></script>
        <script src="/2024-2025-ZK_Data_Librarian_Modul_3/js/search.js?1739985621" defer></script>
      </div>
      <div id="R-homelinks" class="default-animation homelinks">
        <ul>
          <li><a class="padding" href="/2024-2025-ZK_Data_Librarian_Modul_3/index.html"><i class="fa-fw fas fa-home"></i> Home</a></li>
        </ul>
        <hr class="padding">
      </div>
      <div id="R-content-wrapper" class="highlightable">
        <div id="R-shortcutmenu-home" class="R-sidebarmenu">
          <ul class="enlarge morespace collapsible-menu">
            <li class="" data-nav-id="/2024-2025-ZK_Data_Librarian_Modul_3/organisation/index.html"><a class="padding" href="/2024-2025-ZK_Data_Librarian_Modul_3/organisation/index.html"><b>1. </b>Kursorganisation und Vorbereitungen<i class="fa-fw fas fa-check read-icon"></i></a><ul id="R-subsections-e5666dad859f15b521ca9191c5058004" class="collapsible-menu"></ul></li>
            <li class="" data-nav-id="/2024-2025-ZK_Data_Librarian_Modul_3/basics/index.html"><a class="padding" href="/2024-2025-ZK_Data_Librarian_Modul_3/basics/index.html"><b>2. </b>Grundbegriffe der Statistik und Einführung in Pandas<i class="fa-fw fas fa-check read-icon"></i></a><ul id="R-subsections-0b672522ed89c7ef2dda1a5f8d779fdb" class="collapsible-menu"></ul></li>
            <li class="" data-nav-id="/2024-2025-ZK_Data_Librarian_Modul_3/descriptive_statistics/index.html"><a class="padding" href="/2024-2025-ZK_Data_Librarian_Modul_3/descriptive_statistics/index.html"><b>3. </b>Deskriptive Statistik und Visualisierungen<i class="fa-fw fas fa-check read-icon"></i></a><ul id="R-subsections-0c0d8f1f63347052320c9e87849f562a" class="collapsible-menu"></ul></li>
            <li class="" data-nav-id="/2024-2025-ZK_Data_Librarian_Modul_3/inference/index.html"><a class="padding" href="/2024-2025-ZK_Data_Librarian_Modul_3/inference/index.html"><b>4. </b>Exkurs: Inferenzstatistik<i class="fa-fw fas fa-check read-icon"></i></a><ul id="R-subsections-f4750354c8114f32008d1ca30b7fc4da" class="collapsible-menu"></ul></li>
            <li class="" data-nav-id="/2024-2025-ZK_Data_Librarian_Modul_3/machine_learning_basics/index.html"><a class="padding" href="/2024-2025-ZK_Data_Librarian_Modul_3/machine_learning_basics/index.html"><b>5. </b>Machinelles Lernen - Grundlagen<i class="fa-fw fas fa-check read-icon"></i></a><ul id="R-subsections-ecb5224423404190c469dcf9996e3026" class="collapsible-menu"></ul></li>
            <li class="" data-nav-id="/2024-2025-ZK_Data_Librarian_Modul_3/machine_learning_methods/index.html"><a class="padding" href="/2024-2025-ZK_Data_Librarian_Modul_3/machine_learning_methods/index.html"><b>6. </b>Machinelles Lernen - Praxis mit scikit-learn<i class="fa-fw fas fa-check read-icon"></i></a><ul id="R-subsections-2a198e355029ffef7e198cde4a8775bd" class="collapsible-menu"></ul></li>
            <li class="parent " data-nav-id="/2024-2025-ZK_Data_Librarian_Modul_3/text_analysis/index.html"><a class="padding" href="/2024-2025-ZK_Data_Librarian_Modul_3/text_analysis/index.html"><b>7. </b>Machinelles Lernen - Automatische Textanalyse<i class="fa-fw fas fa-check read-icon"></i></a><ul id="R-subsections-2316cdb60d382658238fea834287a286" class="collapsible-menu">
            <li class="active " data-nav-id="/2024-2025-ZK_Data_Librarian_Modul_3/text_analysis/text_classification/index.html"><a class="padding" href="/2024-2025-ZK_Data_Librarian_Modul_3/text_analysis/text_classification/index.html">Text-Klassifikation<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/2024-2025-ZK_Data_Librarian_Modul_3/text_analysis/quiz/index.html"><a class="padding" href="/2024-2025-ZK_Data_Librarian_Modul_3/text_analysis/quiz/index.html">Quiz<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/2024-2025-ZK_Data_Librarian_Modul_3/text_analysis/solutions/index.html"><a class="padding" href="/2024-2025-ZK_Data_Librarian_Modul_3/text_analysis/solutions/index.html">Musterlösungen<i class="fa-fw fas fa-check read-icon"></i></a></li></ul></li>
            <li class="" data-nav-id="/2024-2025-ZK_Data_Librarian_Modul_3/data/index.html"><a class="padding" href="/2024-2025-ZK_Data_Librarian_Modul_3/data/index.html">Data<i class="fa-fw fas fa-check read-icon"></i></a></li>
          </ul>
        </div>
        <div id="R-shortcutmenu-shortcuts" class="R-sidebarmenu">
          <div class="nav-title padding">More</div>
          <ul class="space collapsible-menu">
            <li class="" data-nav-id="/2024-2025-ZK_Data_Librarian_Modul_3/solutions/"><a class="padding" href="/2024-2025-ZK_Data_Librarian_Modul_3/solutions/"><i class='fas fa-cookie-bite'></i> Lösungen zu den Kursaufgaben<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="/2024-2025-ZK_Data_Librarian_Modul_3/organisation/schedule/"><a class="padding" href="/2024-2025-ZK_Data_Librarian_Modul_3/organisation/schedule/"><i class='far fa-calendar-check'></i> Termine und Überblick<i class="fa-fw fas fa-check read-icon"></i></a></li>
            <li class="" data-nav-id="https://zbiw.th-koeln.de/moodle/course/view.php?id=663&amp;section=3"><a class="padding" href="https://zbiw.th-koeln.de/moodle/course/view.php?id=663&section=3" rel="external" target="_blank"><i class='fas fa-users'></i> Moodle Kursumgebung<i class="fa-fw fas fa-check read-icon"></i></a></li>
          </ul>
        </div>
        <div class="padding footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showVisitedLinks showFooter"></div>
        <div id="R-menu-footer">
          <hr class="padding default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showVisitedLinks showFooter">
          <div id="R-prefooter" class="footerLangSwitch footerVariantSwitch footerVisitedLinks showVisitedLinks">
            <ul>
              <li id="R-select-language-container" class="footerLangSwitch">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-language"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <label class="a11y-only" for="R-select-language">Language</label>
                    <select id="R-select-language" onchange="location = this.querySelector( this.value ).dataset.url;">
                      <option id="R-select-language-en" value="#R-select-language-en" data-url="/2024-2025-ZK_Data_Librarian_Modul_3/text_analysis/text_classification/index.html" lang="de-DE" selected></option>
                    </select>
                  </div>
                  <div class="clear"></div>
                </div>
              </li>
              <li id="R-select-variant-container" class="footerVariantSwitch">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-paint-brush"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <label class="a11y-only" for="R-select-variant">Theme</label>
                    <select id="R-select-variant" onchange="window.relearn.changeVariant( this.value );">
                      <option id="R-select-variant-green" value="green" selected>Green</option>
                    </select>
                  </div>
                  <div class="clear"></div>
                </div>
                <script>window.relearn.markVariant();</script>
              </li>
              <li class="footerVisitedLinks showVisitedLinks">
                <div class="padding menu-control">
                  <i class="fa-fw fas fa-history"></i>
                  <span>&nbsp;</span>
                  <div class="control-style">
                    <button onclick="clearHistory();">Clear History</button>
                  </div>
                  <div class="clear"></div>
                </div>
              </li>
            </ul>
          </div>
          <div id="R-footer" class="footerFooter showFooter"><p><a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution 4.0 International License</a>. Author: <a href="mailto:malte@bonart.de?Subject=Data Librarian" target="_top">Malte Bonart</a> and <a href="mailto:foerstner@zbmed.de?Subject=Data Librarian" target="_top">Konrad Förstner</a>.</p>

          </div>
        </div>
      </div>
    </aside>
    <script src="/2024-2025-ZK_Data_Librarian_Modul_3/js/clipboard.min.js?1739985621" defer></script>
    <script src="/2024-2025-ZK_Data_Librarian_Modul_3/js/perfect-scrollbar.min.js?1739985621" defer></script>
    <script src="/2024-2025-ZK_Data_Librarian_Modul_3/js/theme.js?1739985621" defer></script>
  </body>
</html>
